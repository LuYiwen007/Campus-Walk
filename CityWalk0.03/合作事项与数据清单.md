# 清水河校区 AR 导航落地清单（你要做的事 / 我会做的事）

## 目标
在电子科技大学清水河校区内，实现“几乎贴合实走路径”的 AR 步行导航（转弯、过桥、进出建筑清晰可感知）。

---

## 你要做的事（数据与范围）
- 节点清单（必交）：
  - 字段：id、name、lat、lon、type（intersection/building_entrance/bridge/landmark）、z（可选楼层或高度）、note（可选）
  - 说明：节点应覆盖路口、桥头、建筑入口、广场、校门等关键位置；长路段每 100–200 米设一个中间节点。

- 边清单（必交）：
  - 字段：from、to、bidirectional(true/false)、length(米，可留空我来算)、zLevel（如桥上=1 地面=0 地下=-1）、tags（pedestrian/bridge/stairs/indoor/outdoor 等，可选）、instruction（可选提示语）
  - 说明：边表示“可走的路段”，尽量贴合人行道中心线；上下层、单行、人车混行等要标清楚。

- 优先路线范围（建议先交）：
  - 用途：确定 MVP 首发覆盖的几条主干路线，保障体验最优先。
  - 方式：提交“节点序列”或“起终点对”均可。

- 选交资料（更稳）：
  - 关键路口/桥头/入口的现场照片（3–5 张/点位），便于后续做视觉重定位（VPS）或视觉标记布点。

---

## 我会做的事（实现与集成）
- 数据接入
  - 将 `CampusPath.swift` 改为从 `campus_graph.json` 读取节点/边，统一管理路网数据。
  - 校验节点/边引用一致性，自动补长（length）与基础语义。

- 路径规划
  - 实现 A* 最短路/多目标路径。
  - 支持单向边、层级（zLevel）与语义（bridge/stairs/indoor）。

- 定位与地图匹配
  - 使用 ARKit VIO（视觉+IMU）作为短期平滑位姿。
  - 实现“地图匹配（HMM/粒子滤波）”，将相对轨迹吸附到路网，抑制 GPS 漂移。
  - 预留 VPS/视觉锚点接口，后续可加更高精的全局重定位。

- AR 导航渲染
  - 箭头按路径切线方向、以 3–8 m 为间距贴地摆放；转弯节点使用增强提示（大箭头/门框/地贴）。
  - 桥/楼层变化使用高度/层级提示，避免跨层吸附。

- 工程与验证
  - 首先接入“优先路线范围”，校园内实测调参（平滑/吸附权重）。
  - 完成后逐步扩路网，滚动验证。

---

## 数据示例

### 1) 节点（nodes）
```json
{
  "nodes": [
    { "id": "lib_gate", "name": "图书馆正门", "lat": 30.763400, "lon": 103.925400, "type": "building_entrance", "z": 0 },
    { "id": "central_square", "name": "中央广场", "lat": 30.763500, "lon": 103.926500, "type": "intersection", "z": 0 },
    { "id": "bridge_east", "name": "东侧人行桥", "lat": 30.764200, "lon": 103.927100, "type": "bridge", "z": 1 }
  ]
}
```

### 2) 边（edges）
```json
{
  "edges": [
    { "from": "lib_gate", "to": "central_square", "bidirectional": true, "length": 150, "zLevel": 0, "tags": ["pedestrian"], "instruction": "直行150米到中央广场" },
    { "from": "central_square", "to": "bridge_east", "bidirectional": true, "length": 180, "zLevel": 1, "tags": ["pedestrian", "bridge"], "instruction": "上桥后向东直行" }
  ]
}
```

### 3) 优先路线范围（二选一）
- 节点序列法：
```json
{
  "priorityRoutes": [
    ["west_gate", "lib_gate", "central_square", "teachingA_entry", "canteen_main"],
    ["north_dorm", "central_square", "sports_field", "east_gate"]
  ]
}
```

- 起终点法：
```json
{
  "priorityPairs": [
    { "from": "west_gate", "to": "canteen_main" },
    { "from": "north_dorm", "to": "teachingA_entry" }
  ]
}
```

---

## 提交方式与命名建议
- 以 JSON/CSV/Excel 发送均可；JSON 推荐文件名：`campus_graph.json`。
- 坐标系：WGS84（GPS 标准，经纬度小数度）。
- 命名：id 短小明确（如 `lib_gate`/`central_square`），name 中文可读。

---

## 上线节奏建议
1) 第一周：提交“节点清单+2–3条优先路线”的边清单 → 我接入并跑通贴地箭头+转向。
2) 第二周：实测调参，补采缺口，扩到 5–8 条主干线。
3) 后续：逐步覆盖全校；必要时加入 VPS/视觉标记以进一步增强稳准。

---

## 备注
- 仅“很多坐标点”会改善路径规划，但要达到“几乎贴地”，关键在“路网连通 + 地图匹配 + 贴地渲染”。
- VPS/视觉锚点是锦上添花，MVP 不强制；可按优先路口逐步加。


